name: CI

# Build & test on push and pull-request for major platforms. This workflow
# intentionally does not enable the interactive integration tests by default.
# Integration tests are gated behind AXIDEV_IO_RUN_INTEGRATION_TESTS and should
# be executed via the manual `integration-tests` workflow when desired.
on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  build:
    uses: ./.github/workflows/build-reusable.yml
    with:
      matrix-json: |
        [
          {
            "os": "ubuntu-latest",
            "arch": "x64",
            "build-type": "Release",
            "build-tests": true,
            "run-tests": true
          },
          {
            "os": "windows-latest",
            "arch": "x64",
            "build-type": "Release",
            "build-tests": true,
            "run-tests": true
          }
        ]
